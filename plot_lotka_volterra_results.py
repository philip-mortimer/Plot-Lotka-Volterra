"""
    Copyright 2020 Philip Mortimer
    
    This file is part of Philip Mortimer Example Programs.
    
    Philip Mortimer Example Programs is free software: you can redistribute it 
    and/or modify it under the terms of the GNU General Public License as 
    published by the Free Software Foundation, either version 3 of the License,
    or (at your option) any later version.
    
    Philip Mortimer Example Programs is distributed in the hope that it will be
    useful, but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.
    
    You should have received a copy of the GNU General Public License
    along with Philip Mortimer Example Programs.  If not, see 
    <https://www.gnu.org/licenses/>.
"""


import matplotlib.pyplot as plt

import lotka_volterra_model as lv


MAIN_TITLE = 'Lotka-Volterra Model'
LINE_WIDTH = 1


def plot_changes_over_time(sub_plot, results: lv.Results):
    sub_plot.plot(
        results.time_series, results.predator_series.values, 
        label=results.predator_series.label, linewidth=LINE_WIDTH
    )
             
    sub_plot.plot(
        results.time_series, results.prey_series.values, 
        label=results.prey_series.label, linewidth=LINE_WIDTH
    )
    
    sub_plot.set_title('Changes over time')
    sub_plot.set_xlabel('Time')
    sub_plot.set_ylabel('Population density')

    sub_plot.legend()
    sub_plot.grid(True)


def plot_predators_vs_prey(sub_plot, results: lv.Results):
    sub_plot.plot(
        results.prey_series.values, results.predator_series.values,
        linewidth=LINE_WIDTH
    )

    sub_plot.set_title('Predators vs. prey')
    sub_plot.set_xlabel(results.prey_series.label + ' population density')
    sub_plot.set_ylabel(results.predator_series.label + ' population density')

    sub_plot.grid(True)


import lotka_volterra_model as lv

def plot_lotka_volterra_results(results: lv.Results):
    """                                                                                                        
    Draws 2 sub-plots using the results generated by running the 
    Lotka-Volterra model. Each of the sub-plots is a line plot.
    
    The first sub-plot shows changes in predator and prey population densities
    over time.
    
    The second sub-plot is a phase-space plot which shows predator population 
    densities against prey population densities.
    """
    
    # Create the 2 sub-plots laid out horizontally.
    figure, (changes, pred_vs_prey) = plt.subplots(1, 2)
    
    figure.canvas.set_window_title(MAIN_TITLE)
    figure.suptitle(MAIN_TITLE)
    
    # Draw the line plots in the sub-plots.
    plot_changes_over_time(changes, results)
    plot_predators_vs_prey(pred_vs_prey, results)
    
    # Increase width of window containing the sub-plots so that they do not
    # look 'squashed' when laid out horizontally.
    width, height = figure.get_size_inches()
    figure.set_size_inches(width*2, height)   

    plt.show()
